<div class="api-demo-container">
  <h2>API Demo - HTTP Requests</h2>
  <p>Template-driven form to perform POST and GET requests using JSONPlaceholder API.</p>

  <!-- POST: Create New Post -->
  <div class="section">
    <h3>1. Create New Post (POST)</h3>
    <form #postForm="ngForm" (ngSubmit)="submitPost(postForm)">
      <div class="form-group">
        <label for="title">Title:</label>
        <input 
          type="text" 
          id="title" 
          name="title"
          ngModel
          placeholder="Enter post title"
          required>
      </div>

      <div class="form-group">
        <label for="body">Body:</label>
        <textarea 
          id="body" 
          name="body"
          ngModel
          placeholder="Enter post content"
          rows="4"
          required></textarea>
      </div>

      <div class="form-group">
        <label for="userId">User ID:</label>
        <input 
          type="number" 
          id="userId" 
          name="userId"
          ngModel
          placeholder="Enter user ID"
          required>
      </div>

      <button type="submit" class="btn btn-primary">
        Submit
      </button>
    </form>

    <!-- POST Response -->
    <div *ngIf="responseData" class="response-section">
      <h4>‚úÖ Post Created Successfully!</h4>
      <div class="response-data">
        <p><strong>ID:</strong> {{ responseData.id }}</p>
        <p><strong>Title:</strong> {{ responseData.title }}</p>
        <p><strong>Body:</strong> {{ responseData.body }}</p>
        <p><strong>User ID:</strong> {{ responseData.userId }}</p>
      </div>
    </div>
  </div>

  <!-- GET: Fetch All Posts -->
  <div class="section">
    <h3>2. Get All Posts (GET)</h3>
    <button (click)="getAllPosts()" class="btn btn-secondary">
      Get All Posts
    </button>

    <div *ngIf="allPosts.length > 0" class="response-section">
      <h4>üìã All Posts (First 10):</h4>
      <div class="posts-grid">
        <div *ngFor="let post of allPosts" class="post-card">
          <h5>{{ post.title }}</h5>
          <p><strong>ID:</strong> {{ post.id }}</p>
          <p><strong>User ID:</strong> {{ post.userId }}</p>
          <p class="post-body">{{ post.body | slice:0:100 }}{{ post.body.length > 100 ? '...' : '' }}</p>
        </div>
      </div>
    </div>
  </div>

  <!-- GET: Fetch Single Post -->
  <div class="section">
    <h3>3. Get Single Post by ID (GET)</h3>
    <div class="form-group">
      <label for="postId">Post ID:</label>
      <input 
        type="number" 
        id="postId" 
        [(ngModel)]="postId"
        min="1" 
        max="100"
        placeholder="Enter post ID">
      <button (click)="getSinglePost()" class="btn btn-secondary">
        Get Post
      </button>
    </div>

    <div *ngIf="singlePost" class="response-section">
      <h4>üìÑ Single Post Retrieved:</h4>
      <div class="single-post">
        <p><strong>ID:</strong> {{ singlePost.id }}</p>
        <p><strong>Title:</strong> {{ singlePost.title }}</p>
        <p><strong>User ID:</strong> {{ singlePost.userId }}</p>
        <p><strong>Body:</strong> {{ singlePost.body }}</p>
      </div>
    </div>
  </div>

  <!-- PUT: Update Post -->
  <div class="section">
    <h3>4. Update Post by ID (PUT)</h3>
    <form #updateForm="ngForm" (ngSubmit)="updatePost(updateForm)">
      <div class="form-group">
        <label for="updatePostId">Post ID to Update:</label>
        <input 
          type="number" 
          id="updatePostId" 
          [(ngModel)]="updatePostId"
          name="updatePostId"
          min="1" 
          max="100"
          placeholder="Enter post ID to update"
          required>
      </div>

      <div class="form-group">
        <label for="updateTitle">New Title:</label>
        <input 
          type="text" 
          id="updateTitle" 
          name="title"
          ngModel
          placeholder="Enter new post title"
          required>
      </div>

      <div class="form-group">
        <label for="updateBody">New Body:</label>
        <textarea 
          id="updateBody" 
          name="body"
          ngModel
          placeholder="Enter new post content"
          rows="4"
          required></textarea>
      </div>

      <div class="form-group">
        <label for="updateUserId">User ID:</label>
        <input 
          type="number" 
          id="updateUserId" 
          name="userId"
          ngModel
          placeholder="Enter user ID"
          required>
      </div>

      <button type="submit" class="btn btn-warning">
        Update Post
      </button>
    </form>

    <!-- PUT Response -->
    <div *ngIf="updateResponse" class="response-section">
      <h4>‚úÖ Post Updated Successfully!</h4>
      <div class="response-data">
        <p><strong>ID:</strong> {{ updateResponse.id }}</p>
        <p><strong>Title:</strong> {{ updateResponse.title }}</p>
        <p><strong>Body:</strong> {{ updateResponse.body }}</p>
        <p><strong>User ID:</strong> {{ updateResponse.userId }}</p>
      </div>
    </div>
  </div>

  <!-- DELETE: Delete Post -->
  <div class="section">
    <h3>5. Delete Post by ID (DELETE)</h3>
    <div class="form-group">
      <label for="deletePostId">Post ID to Delete:</label>
      <input 
        type="number" 
        id="deletePostId" 
        [(ngModel)]="deletePostId"
        min="1" 
        max="100"
        placeholder="Enter post ID to delete">
      <button (click)="deletePost()" class="btn btn-danger">
        Delete Post
      </button>
    </div>

    <!-- DELETE Response -->
    <div *ngIf="deleteResponse" class="response-section">
      <h4>‚úÖ Post Deleted Successfully!</h4>
      <div class="response-data">
        <p><strong>Deleted Post ID:</strong> {{ deleteResponse.id }}</p>
        <p><strong>Status:</strong> {{ deleteResponse.message }}</p>
      </div>
    </div>
  </div>

  <!-- SEARCH: Search Posts with Query Parameters -->
  <div class="section">
    <h3>6. Search Posts by User ID (Query Parameters)</h3>
    <div class="form-group">
      <label for="searchUserId">User ID to Search:</label>
      <input 
        type="number" 
        id="searchUserId" 
        [(ngModel)]="searchUserId"
        min="1" 
        max="10"
        placeholder="Enter user ID">
      <button (click)="searchPostsByUserId()" class="btn btn-info">
        Search Posts
      </button>
    </div>

    <!-- Search Results -->
    <div *ngIf="searchResults.length > 0" class="response-section">
      <h4>üîç Search Results (Posts by User {{ searchUserId }}):</h4>
      <div class="posts-grid">
        <div *ngFor="let post of searchResults" class="post-card">
          <h5>{{ post.title }}</h5>
          <p><strong>ID:</strong> {{ post.id }}</p>
          <p><strong>User ID:</strong> {{ post.userId }}</p>
          <p class="post-body">{{ post.body | slice:0:100 }}{{ post.body.length > 100 ? '...' : '' }}</p>
        </div>
      </div>
    </div>
  </div>

  <!-- API Info -->
  <div class="api-info">
    <h4>üîó API Information</h4>
    <p><strong>Base URL:</strong> https://jsonplaceholder.typicode.com/posts</p>
    <ul>
      <li><strong>POST /posts</strong> - Create a new post (with query params: source, version)</li>
      <li><strong>GET /posts</strong> - Get all posts (with query params: _limit, _sort, _order)</li>
      <li><strong>GET /posts/:id</strong> - Get a single post by ID (with optional _embed=comments)</li>
      <li><strong>PUT /posts/:id</strong> - Update an existing post (with timestamp query param)</li>
      <li><strong>DELETE /posts/:id</strong> - Delete a post by ID (with confirm=true query param)</li>
      <li><strong>GET /posts?userId=X</strong> - Search posts by user ID (with limit query param)</li>
    </ul>
    <p><strong>Query Parameters Examples:</strong></p>
    <ul>
      <li>_limit=10 - Limit results to 10 items</li>
      <li>_sort=id&_order=desc - Sort by ID in descending order</li>
      <li>userId=1 - Filter posts by user ID</li>
      <li>_embed=comments - Include related comments</li>
    </ul>
    
    <h4>üîê HTTP Interceptors</h4>
    <p><strong>Active Interceptors:</strong></p>
    <ul>
      <li><strong>AuthInterceptor</strong> - Prints a message when request is intercepted</li>
    </ul>
    <p><strong>Note:</strong> Check the browser console to see interceptor logs when making API requests!</p>
  </div>
</div>
